<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [fetchmail-devel] [Bug #15103] Fetchmail Fails with ASSP	(http://assp.sourceforge.net/)
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/fetchmail-devel/2009-January/index.html" >
   <LINK REL="made" HREF="mailto:fetchmail-devel%40lists.berlios.de?Subject=Re%3A%20%5Bfetchmail-devel%5D%20%5BBug%20%2315103%5D%20Fetchmail%20Fails%20with%20ASSP%0A%09%28http%3A//assp.sourceforge.net/%29&In-Reply-To=%3C200901230736.n0N7aKNc015309%40unicorn.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001048.html">
   <LINK REL="Next"  HREF="001039.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[fetchmail-devel] [Bug #15103] Fetchmail Fails with ASSP	(http://assp.sourceforge.net/)</H1>
    <B>admin at berlios.de</B> 
    <A HREF="mailto:fetchmail-devel%40lists.berlios.de?Subject=Re%3A%20%5Bfetchmail-devel%5D%20%5BBug%20%2315103%5D%20Fetchmail%20Fails%20with%20ASSP%0A%09%28http%3A//assp.sourceforge.net/%29&In-Reply-To=%3C200901230736.n0N7aKNc015309%40unicorn.berlios.de%3E"
       TITLE="[fetchmail-devel] [Bug #15103] Fetchmail Fails with ASSP	(http://assp.sourceforge.net/)">admin at berlios.de
       </A><BR>
    <I>Fri Jan 23 08:36:20 CET 2009</I>
    <P><UL>
        <LI>Previous message: <A HREF="001048.html">[fetchmail-devel] POP3 UIDL behavior
</A></li>
        <LI>Next message: <A HREF="001039.html">[fetchmail-devel] [Bug #15103] Fetchmail Fails with	ASSP	(http://assp.sourceforge.net/)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1036">[ date ]</a>
              <a href="thread.html#1036">[ thread ]</a>
              <a href="subject.html#1036">[ subject ]</a>
              <a href="author.html#1036">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Bug #15103, was updated on 2009-Jan-23 07:36
Here is a current snapshot of the bug.

Project: Community Fetchmail
Category: None
Status: Open
Resolution: None
Bug Group: None
Priority: 5
Submitted by: darthasp
Assigned to : none
Summary: Fetchmail Fails with ASSP (<A HREF="http://assp.sourceforge.net/">http://assp.sourceforge.net/</A>)

Details: Hi There,

I am trying to download messages from a catchall mailbox and forward them on to a mail server that sits been an ASSP installation.

The problem I am having is that ASSP only looks at the first 2000 bytes of the message in order to determine whether it is SPAM or not.

If the message that Fetchmail is sending is larger than this size and ASSP considers it to be SPAM - ASSP closes the connection with a 550: response before Fetchmail has finished copying the mail.

Fetchmail then errors with Query status=6 (IOERR)

It does not delete the message or mark it as seen.

next time fetchmail logs in try's to send the message again with the same result.

I can increase the amount of bytes that ASSP looks at and while this solves the issue temporary it is not a permanent solution.  ASSP was not designed to look that the whole message.
When I increase the amount of bytes ASSP looks at the system resources go through the roof.

Is it possible that Fetchmail could somehow recognise the 550 response from ASSP half way through message sending.

I have enclosed log file for you to look at

Hope you can help 

Regards

Phil 

fetchmail: SMTP&gt; MAIL FROM:&lt;externaluser&gt; SIZE=861742
fetchmail: SMTP&lt; 250 2.1.0 externaluser....Sender OK
fetchmail: SMTP&gt; RCPT TO:&lt;internaluser&gt;
fetchmail: SMTP&lt; 250 2.1.5 internaluser
fetchmail: SMTP&gt; DATA
fetchmail: SMTP&lt; 354 Start mail input; end with &lt;CRLF&gt;.&lt;CRLF&gt;
fetchmail: error writing message text
fetchmail: POP3&gt; QUIT
fetchmail: POP3&lt; O07etM6Coi+kFL/DyxZouBPCFDIAEiwZWHF6pjPuZt2vAR+/F0pCL8Re3Qva/m6kfYL7EsD+Vd52
fetchmail: MDA error while fetching from <A HREF="https://lists.berlios.de/mailman/listinfo/fetchmail-devel">shrelay at domain</A>@mail.domain
fetchmail: 6.3.9 querying server1 (protocol POP3) at Fri Jan 23 07:26:46 2009: poll completed
fetchmail: Query status=6 (IOERR)
fetchmail: normal termination, status 6
fetchmail: 1 message for <A HREF="https://lists.berlios.de/mailman/listinfo/fetchmail-devel">shrelay at domain</A> at mail.domain (861742 octets).
fetchmail: reading message <A HREF="https://lists.berlios.de/mailman/listinfo/fetchmail-devel">shrelay at domain</A>@mail.domain:1 of 1 (861742 octets) (log message incomplete)fetchmail: error writing message text
fetchmail: MDA error while fetching from <A HREF="https://lists.berlios.de/mailman/listinfo/fetchmail-devel">shrelay at domain</A>@mail.domain
fetchmail: Query status=6 (IOERR)

For detailed info, follow this link:
<A HREF="http://developer.berlios.de/bugs/?func=detailbug&amp;bug_id=15103&amp;group_id=1824">http://developer.berlios.de/bugs/?func=detailbug&amp;bug_id=15103&amp;group_id=1824</A>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001048.html">[fetchmail-devel] POP3 UIDL behavior
</A></li>
	<LI>Next message: <A HREF="001039.html">[fetchmail-devel] [Bug #15103] Fetchmail Fails with	ASSP	(http://assp.sourceforge.net/)
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1036">[ date ]</a>
              <a href="thread.html#1036">[ thread ]</a>
              <a href="subject.html#1036">[ subject ]</a>
              <a href="author.html#1036">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/fetchmail-devel">More information about the fetchmail-devel
mailing list</a><br>
</body></html>
