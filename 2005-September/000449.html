<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [fetchmail-devel] Re: Fetchmail, NTLM and Exchange
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/fetchmail-devel/2005-September/index.html" >
   <LINK REL="made" HREF="mailto:fetchmail-devel%40lists.berlios.de?Subject=Re%3A%20%5Bfetchmail-devel%5D%20Re%3A%20Fetchmail%2C%20NTLM%20and%20Exchange&In-Reply-To=%3C20050917190538.GA14219%40merlin.emma.line.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000447.html">
   <LINK REL="Next"  HREF="000455.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[fetchmail-devel] Re: Fetchmail, NTLM and Exchange</H1>
    <B>Matthias Andree</B> 
    <A HREF="mailto:fetchmail-devel%40lists.berlios.de?Subject=Re%3A%20%5Bfetchmail-devel%5D%20Re%3A%20Fetchmail%2C%20NTLM%20and%20Exchange&In-Reply-To=%3C20050917190538.GA14219%40merlin.emma.line.org%3E"
       TITLE="[fetchmail-devel] Re: Fetchmail, NTLM and Exchange">matthias.andree at gmx.de
       </A><BR>
    <I>Sat Sep 17 21:05:38 CEST 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="000447.html">[fetchmail-devel] Contents of file `fetchmail-6.2.9-rc2.ru.po'
</A></li>
        <LI>Next message: <A HREF="000455.html">[fetchmail-devel] Re: Fetchmail, NTLM and Exchange
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#449">[ date ]</a>
              <a href="thread.html#449">[ thread ]</a>
              <a href="subject.html#449">[ subject ]</a>
              <a href="author.html#449">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Sat, 17 Sep 2005, Yves Boisjoly wrote:

&gt;<i> Unfortunately, my employer decided to move to... Guess what... Exchange!
</I>
Eek.

&gt;<i> I was using Linux and Pine with fetchmail for my mail since two years. I
</I>&gt;<i> recently got a Cisco VPN client for Linux and the last thing I have to fix in
</I>&gt;<i> this migration is my mail.
</I>&gt;<i> 
</I>&gt;<i> I tried and tried to telnet on port 110, used fetchmail with the NTLM
</I>&gt;<i> authentication, without any success.
</I>&gt;<i> 
</I>&gt;<i> I read a lot about the NTLM authentication and I do realised that it doesn't
</I>&gt;<i> seem to be so easy to bypass the authentication level.
</I>&gt;<i> 
</I>&gt;<i> I also read that fetchmail can use the NTLM authentication over IMAP with
</I>&gt;<i> Exchange, but the Exchange server I have to use only listen on POP3 (110).
</I>
fetchmail has code in place to do NTLM auth with POP3, too, although the
manual page doesn't say so. Can you show the &quot;fetchmail --nosyslog -Nvv&quot;
snippet that shows the NTLM negotiation attempt?

&gt;<i> I even tried with the Evolution client, apparently the better one to
</I>&gt;<i> communicate with Exchange, but again, without good result.
</I>&gt;<i> 
</I>&gt;<i> I also tried to sniff my connection communication with the server, into
</I>&gt;<i> Windows (shame on me!)... Everything is encrypted but I saw the &quot;NTLM&quot; string
</I>&gt;<i> at some point...
</I>
Might just have been an advertisement.

Can you telnet to Exchange port 110, type CAPA and see what you get
(this is redundant if the fetchmail command above showed this
information already).

&gt;<i> So here are my two questions:
</I>&gt;<i> 
</I>&gt;<i> 	Is there any development in fetchmail for Exchange?
</I>
Not on my part, as I don't have Exchange accounts to test against. If
you could arrange for a test account for the fetchmail project, that
might help - we need a mail address where we can send our test mail and
the POP3 account to pull the mail from.

&gt;<i> 	If not, considering that I am pretty good with Perl, do you thing it
</I>&gt;<i> could be feasible to incorporate a Perl call into fetchmail, that would take
</I>&gt;<i> over the NTLM authentication, and give back the control to fetchmail after
</I>&gt;<i> the authentication transaction?
</I>
Such code is already there - the &quot;plugin&quot; option can do what you want.
Your plugin would have to connect (TCP-wise) to the POP3 server, do the
NTLM stuff and then either abort or transparently transport all commands
(bidirectionally, so you'll probably have to delve into select() magic,
it's possible in Perl but looks ugly) until it has had EOF from both
sides.

&gt;<i> I could be interested to develop this part in Perl, but I don't want to go
</I>&gt;<i> into C++, if it's what fetchmail is developed with...
</I>
fetchmail is done in C currently, and the best way would probably be to
fix NTLM auth.

-- 
Matthias Andree

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000447.html">[fetchmail-devel] Contents of file `fetchmail-6.2.9-rc2.ru.po'
</A></li>
	<LI>Next message: <A HREF="000455.html">[fetchmail-devel] Re: Fetchmail, NTLM and Exchange
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#449">[ date ]</a>
              <a href="thread.html#449">[ thread ]</a>
              <a href="subject.html#449">[ subject ]</a>
              <a href="author.html#449">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/fetchmail-devel">More information about the fetchmail-devel
mailing list</a><br>
</body></html>
