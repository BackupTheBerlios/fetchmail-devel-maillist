<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [fetchmail-devel] Security vulnerability in APOP authentication
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/fetchmail-devel/2007-March/index.html" >
   <LINK REL="made" HREF="mailto:fetchmail-devel%40lists.berlios.de?Subject=Re%3A%20%5Bfetchmail-devel%5D%20Security%20vulnerability%20in%20APOP%20authentication&In-Reply-To=%3C20070317230355.GA26584%40merlin.emma.line.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000887.html">
   <LINK REL="Next"  HREF="000890.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[fetchmail-devel] Security vulnerability in APOP authentication</H1>
    <B>Matthias Andree</B> 
    <A HREF="mailto:fetchmail-devel%40lists.berlios.de?Subject=Re%3A%20%5Bfetchmail-devel%5D%20Security%20vulnerability%20in%20APOP%20authentication&In-Reply-To=%3C20070317230355.GA26584%40merlin.emma.line.org%3E"
       TITLE="[fetchmail-devel] Security vulnerability in APOP authentication">matthias.andree at gmx.de
       </A><BR>
    <I>Sun Mar 18 00:03:55 CET 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000887.html">[fetchmail-devel] Security vulnerability in APOP authentication
</A></li>
        <LI>Next message: <A HREF="000890.html">[fetchmail-devel] Security vulnerability in APOP authentication
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#889">[ date ]</a>
              <a href="thread.html#889">[ thread ]</a>
              <a href="subject.html#889">[ subject ]</a>
              <a href="author.html#889">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Ga&#235;tan LEURENT schrieb am 2007-03-14:

&gt;<i> I found a security vulnerability in the APOP authentication.  It is
</I>&gt;<i> related to recent collision attacks by Wang and al. against MD5.  The
</I>&gt;<i> basic idea is to craft a pair of message-ids that will collide in the
</I>&gt;<i> APOP hash if the password begins in a specified way.  So the attacker
</I>&gt;<i> would impersonate a POP server, and send these msg-id; the client will
</I>&gt;<i> return the hash, and the attacker can learn some password characters.
</I>
Thanks for the heads-up.

The problem with APOP is that it specifies MD5, and that isn't going to
change, and with some clueless upstreams, APOP is the best you can
get...

&gt;<i> This attack is really a practical one: it needs about an hour of
</I>&gt;<i> computation and a few hundred authentications from the client, and can
</I>&gt;<i> recover three password characters.  I tested it against fetchmail, and
</I>&gt;<i> it does work.
</I>
How does this work in detail? Recover character by character? Are
specially-crafted challenges required to provoke weak messages in MD5,
if there are any?

What's the state of the MD5 cracking art WRT unknown plaintext, how big
is the effort to brute force the 85^5 space from the 1,000 hashes thus
collected?

I don't know details beyond that someone has a way to produce two
messages with colliding hash with reasonably little effort.

&gt;<i> However, using the current techniques available to attack MD5, the
</I>&gt;<i> msg-ids sent by the server can easily be distinguished from genuine ones
</I>&gt;<i> as they will not respect the RFC specification.
</I>
How long until these colliding messages ASCII and RFC-822 message-id format

&gt;<i> In particular, they
</I>&gt;<i> will contain non-ASCII characters.  Therefore, as a security
</I>&gt;<i> countermeasure, I think fetchmail should reject msg-ids that does not
</I>&gt;<i> conform to the RFC.
</I>
That is certainly feasible to implement, I wonder though if that helps
us out for long.

&gt;<i> The details of the attack and the new results against MD5 needed to
</I>&gt;<i> build it will be presented in the Fast Software Encryption conference on
</I>&gt;<i> March 28.  I can send you some more details if needed.
</I>
That would certainly be interesting - who will present the attack at the
conference? Is the paper available for download or will it be after the
conference?

&gt;<i> Meanwhile, feel free to alert any one that you believe is concerned.
</I>&gt;<i> I am already sending this mail to the maintainers of Thunderbird,
</I>&gt;<i> Evolution, fetchmail, and mutt.  KMail already seems to do enough checks
</I>&gt;<i> on the msg-id to avoid the attack.
</I>
I think I'll be easy on this one until after I've seen the details.

Best regards,

-- 
Matthias Andree

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000887.html">[fetchmail-devel] Security vulnerability in APOP authentication
</A></li>
	<LI>Next message: <A HREF="000890.html">[fetchmail-devel] Security vulnerability in APOP authentication
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#889">[ date ]</a>
              <a href="thread.html#889">[ thread ]</a>
              <a href="subject.html#889">[ subject ]</a>
              <a href="author.html#889">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/fetchmail-devel">More information about the fetchmail-devel
mailing list</a><br>
</body></html>
