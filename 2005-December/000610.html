<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [fetchmail-devel] [PATCH] fix listener mode
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/fetchmail-devel/2005-December/index.html" >
   <LINK REL="made" HREF="mailto:fetchmail-devel%40lists.berlios.de?Subject=Re%3A%20%5Bfetchmail-devel%5D%20%5BPATCH%5D%20fix%20listener%20mode&In-Reply-To=%3Cm3vexlbf2w.fsf%40merlin.emma.line.org%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000602.html">
   <LINK REL="Next"  HREF="000613.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[fetchmail-devel] [PATCH] fix listener mode</H1>
    <B>Matthias Andree</B> 
    <A HREF="mailto:fetchmail-devel%40lists.berlios.de?Subject=Re%3A%20%5Bfetchmail-devel%5D%20%5BPATCH%5D%20fix%20listener%20mode&In-Reply-To=%3Cm3vexlbf2w.fsf%40merlin.emma.line.org%3E"
       TITLE="[fetchmail-devel] [PATCH] fix listener mode">matthias.andree at gmx.de
       </A><BR>
    <I>Mon Dec 19 10:39:51 CET 2005</I>
    <P><UL>
        <LI>Previous message: <A HREF="000602.html">[fetchmail-devel] [PATCH] fix listener mode [WAS: Re: RFC: Patch to fix Berlios Bug #5849]
</A></li>
        <LI>Next message: <A HREF="000613.html">[fetchmail-devel] Re: fix listener mode
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#610">[ date ]</a>
              <a href="thread.html#610">[ thread ]</a>
              <a href="subject.html#610">[ subject ]</a>
              <a href="author.html#610">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Sunil Shetye &lt;<A HREF="https://lists.berlios.de/mailman/listinfo/fetchmail-devel">shetye at bombay.retortsoft.com</A>&gt; writes:

&gt;<i> Quoting from Matthias Andree's mail on Tue, Dec 13, 2005:
</I>&gt;&gt;<i> &gt; [OFFTOPIC] While debugging this, I found a weird bug relating to this
</I>&gt;&gt;<i> &gt; SMTP/LMTP mode. It seems that once fetchmail switches to LMTP mode,
</I>&gt;&gt;<i> &gt; there is no going back to SMTP mode. Try this simple fetchmail
</I>&gt;&gt;<i> &gt; command:
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; $ fetchmail -v --smtphost /this/socket/is/down,localhost
</I>&gt;&gt;<i> &gt;
</I>&gt;&gt;<i> &gt; fetchmail sends LHLO to the localhost SMTP server. Note that SMTP
</I>&gt;&gt;<i> &gt; cannot be forced as the user could be running this configuration:
</I>&gt;<i>
</I>&gt;<i> Here is a patch which fixes this issue. This basically removes the
</I>&gt;<i> global smtp_mode variable and passes the desired mode in every smtp
</I>&gt;<i> function.
</I>
Wow, that patch is huge.  I'll happily merge it or something similar
onto the trunk (cleanup is always good), but for 6.3.1 I'd prefer a
smaller patch, even if it means hacking the state structures in some
places (for instance, upon sending a bounce and completion of the bounce
function).

I wonder if bouncing messages is the right thing at all. There should be
no reason to ever bounce in singledrop mode, and multidrop mode should
also only bounce for unknown users (but actually, that's the task of the
upstream servers; catchall OTOH is not a good idea any more nowadays).

&gt;<i> You may compare the output of
</I>&gt;<i>
</I>&gt;<i> $ fetchmail -v --smtphost /this/socket/is/down,localhost
</I>&gt;<i>
</I>&gt;<i> before and after the patch.
</I>
-- 
Matthias Andree

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000602.html">[fetchmail-devel] [PATCH] fix listener mode [WAS: Re: RFC: Patch to fix Berlios Bug #5849]
</A></li>
	<LI>Next message: <A HREF="000613.html">[fetchmail-devel] Re: fix listener mode
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#610">[ date ]</a>
              <a href="thread.html#610">[ thread ]</a>
              <a href="subject.html#610">[ subject ]</a>
              <a href="author.html#610">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/fetchmail-devel">More information about the fetchmail-devel
mailing list</a><br>
</body></html>
